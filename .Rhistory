pc = count / sum) |>
ggplot(aes(x = pc, y = fct_rev(sentiment))) +
geom_col(aes(fill = sentiment)) +
facet_wrap(~rating, scales = "free") +
guides(fill = "none")
google_rating_words |>
inner_join(get_sentiments("nrc")) |>
group_by(sentiment, rating) |>
summarise(count = n_distinct(word),
.groups = "drop") |>
group_by(rating) |>
mutate(sum = sum(count),
pc = count / sum) |>
ggplot(aes(x = pc, y = fct_rev(sentiment))) +
geom_col(aes(fill = sentiment)) +
facet_wrap(~rating, scales = "free") +
scale_x_continuous(labels = percent) +
guides(fill = "none")
google_rating_words |>
inner_join(get_sentiments("nrc")) |>
group_by(sentiment, rating) |>
summarise(count = n_distinct(word),
.groups = "drop") |>
group_by(rating) |>
mutate(sum = sum(count),
pc = count / sum) |>
ggplot(aes(x = pc, y = fct_rev(sentiment))) +
geom_col(aes(fill = sentiment)) +
scale_fill_manual(
values =c(
"anger" = "#780000",
"disgust" = "#c1121f",
"fear" = "#9e2a2b",
"negative" = "#bc4749",
"sadness" = "#b56576",
"anticipation" = "#90e0ef",
"joy" = "#00b4d8",
"surpise" = "#caf0f8",
"positive" = "#0077b6",
"trust" = "#03045e"
)
) +
facet_wrap(~rating, scales = "free") +
scale_x_continuous(labels = percent) +
guides(fill = "none")
google_rating_words |>
inner_join(get_sentiments("nrc")) |>
group_by(sentiment, rating) |>
summarise(count = n_distinct(word),
.groups = "drop") |>
group_by(rating) |>
mutate(sum = sum(count),
pc = count / sum) |>
mutate(sentiment = fct_relevel(sentiment,
c("anticipation",
"surprise",
"joy",
"trust",
"positive",
"negative",
"fear",
"anger",
"disgust",
"sadness"))) |>
ggplot(aes(x = pc, y = fct_rev(sentiment))) +
geom_col(aes(fill = sentiment)) +
scale_fill_manual(
values =c(
"anger" = "#780000",
"disgust" = "#c1121f",
"fear" = "#9e2a2b",
"negative" = "#bc4749",
"sadness" = "#b56576",
"anticipation" = "#90e0ef",
"joy" = "#00b4d8",
"surpise" = "#caf0f8",
"positive" = "#0077b6",
"trust" = "#118ab2"
)
) +
facet_wrap(~rating, scales = "free") +
scale_x_continuous(labels = percent) +
guides(fill = "none")
google_rating_words |>
inner_join(get_sentiments("nrc")) |>
group_by(sentiment, rating) |>
summarise(count = n_distinct(word),
.groups = "drop") |>
group_by(rating) |>
mutate(sum = sum(count),
pc = count / sum) |>
mutate(sentiment = fct_relevel(sentiment,
c("anticipation",
"surprise",
"joy",
"trust",
"positive",
"negative",
"fear",
"sadness",
"anger",
"disgust"))) |>
ggplot(aes(x = pc, y = fct_rev(sentiment))) +
geom_col(aes(fill = sentiment)) +
scale_fill_manual(
values =c(
"anger" = "#780000",
"disgust" = "#c1121f",
"fear" = "#9e2a2b",
"negative" = "#bc4749",
"sadness" = "#b56576",
"anticipation" = "#90e0ef",
"joy" = "#00b4d8",
"surpise" = "#caf0f8",
"positive" = "#0077b6",
"trust" = "#118ab2"
)
) +
facet_wrap(~rating, scales = "free") +
scale_x_continuous(labels = percent) +
guides(fill = "none")
google_rating_words |>
inner_join(get_sentiments("nrc")) |>
group_by(sentiment, rating) |>
summarise(count = n_distinct(word),
.groups = "drop") |>
group_by(rating) |>
mutate(sum = sum(count),
pc = count / sum) |>
mutate(sentiment = fct_relevel(sentiment,
c("anticipation",
"surprise",
"joy",
"trust",
"positive",
"negative",
"fear",
"sadness",
"anger",
"disgust"))) |>
ggplot(aes(x = pc, y = fct_rev(sentiment))) +
geom_col(aes(fill = sentiment)) +
scale_fill_manual(
values =c(
"anger" = "#780000",
"disgust" = "#c1121f",
"fear" = "#9e2a2b",
"negative" = "#bc4749",
"sadness" = "#b56576",
"anticipation" = "#90e0ef",
"joy" = "#00b4d8",
"surprise" = "#caf0f8",
"positive" = "#0077b6",
"trust" = "#118ab2"
)
) +
facet_wrap(~rating, scales = "free") +
scale_x_continuous(labels = percent) +
guides(fill = "none")
google_rating_words |>
inner_join(get_sentiments("nrc")) |>
group_by(sentiment, rating) |>
summarise(count = n_distinct(word),
.groups = "drop") |>
group_by(rating) |>
mutate(sum = sum(count),
pc = count / sum) |>
mutate(sentiment = fct_relevel(sentiment,
c("surprise",
"anticipation",
"joy",
"trust",
"positive",
"negative",
"fear",
"sadness",
"anger",
"disgust"))) |>
ggplot(aes(x = pc, y = fct_rev(sentiment))) +
geom_col(aes(fill = sentiment)) +
scale_fill_manual(
values =c(
"anger" = "#780000",
"disgust" = "#c1121f",
"fear" = "#9e2a2b",
"negative" = "#bc4749",
"sadness" = "#b56576",
"anticipation" = "#90e0ef",
"joy" = "#00b4d8",
"surprise" = "#caf0f8",
"positive" = "#0077b6",
"trust" = "#118ab2"
)
) +
facet_wrap(~rating, scales = "free") +
scale_x_continuous(labels = percent) +
guides(fill = "none")
google_rating_words |>
inner_join(get_sentiments("nrc")) |>
group_by(sentiment, rating) |>
summarise(count = n_distinct(word),
.groups = "drop") |>
group_by(rating) |>
mutate(sum = sum(count),
pc = count / sum) |>
mutate(sentiment = fct_relevel(sentiment,
c("surprise",
"anticipation",
"joy",
"trust",
"positive",
"negative",
"sadness",
"fear",
"anger",
"disgust"))) |>
ggplot(aes(x = pc, y = fct_rev(sentiment))) +
geom_col(aes(fill = sentiment)) +
scale_fill_manual(
values =c(
"anger" = "#780000",
"disgust" = "#c1121f",
"fear" = "#9e2a2b",
"negative" = "#bc4749",
"sadness" = "#b56576",
"anticipation" = "#90e0ef",
"joy" = "#00b4d8",
"surprise" = "#caf0f8",
"positive" = "#0077b6",
"trust" = "#118ab2"
)
) +
facet_wrap(~rating, scales = "free") +
scale_x_continuous(labels = percent) +
guides(fill = "none")
google_rating_words |>
inner_join(get_sentiments("nrc")) |>
group_by(sentiment, rating) |>
summarise(count = n_distinct(word),
.groups = "drop") |>
group_by(rating) |>
mutate(sum = sum(count),
pc = count / sum) |>
mutate(sentiment = fct_relevel(sentiment,
c("surprise",
"anticipation",
"joy",
"trust",
"positive",
"negative",
"sadness",
"fear",
"anger",
"disgust"))) |>
ggplot(aes(x = pc, y = fct_rev(sentiment))) +
geom_col(aes(fill = sentiment)) +
scale_fill_manual(
values =c(
"anger" = "#780000",
"disgust" = "#c1121f",
"fear" = "#9e2a2b",
"negative" = "#bc4749",
"sadness" = "#b56576",
"anticipation" = "#90e0ef",
"joy" = "#00b4d8",
"surprise" = "#caf0f8",
"positive" = "#0077b6",
"trust" = "#118ab2"
)
) +
facet_wrap(~rating, scales = "free") +
scale_x_continuous(labels = percent) +
guides(fill = "none") +
theme(strip.background = element_rect(fill = "black"))
google_rating_words |>
inner_join(get_sentiments("nrc")) |>
group_by(sentiment, rating) |>
summarise(count = n_distinct(word),
.groups = "drop") |>
group_by(rating) |>
mutate(sum = sum(count),
pc = count / sum) |>
mutate(sentiment = fct_relevel(sentiment,
c("surprise",
"anticipation",
"joy",
"trust",
"positive",
"negative",
"sadness",
"fear",
"anger",
"disgust"))) |>
ggplot(aes(x = pc, y = fct_rev(sentiment))) +
geom_col(aes(fill = sentiment)) +
scale_fill_manual(
values =c(
"anger" = "#780000",
"disgust" = "#c1121f",
"fear" = "#9e2a2b",
"negative" = "#bc4749",
"sadness" = "#b56576",
"anticipation" = "#90e0ef",
"joy" = "#00b4d8",
"surprise" = "#caf0f8",
"positive" = "#0077b6",
"trust" = "#118ab2"
)
) +
facet_wrap(~rating, scales = "free") +
scale_x_continuous(labels = percent) +
guides(fill = "none") +
theme(strip.background = element_rect(fill = "black")) +
labs(title = "Breakdown of NRC sentiments in Google reviews by rating",
subtitle = "In the Klang Valley.")
google_rating_words |>
inner_join(get_sentiments("nrc")) |>
group_by(sentiment, rating) |>
summarise(count = n_distinct(word),
.groups = "drop") |>
group_by(rating) |>
mutate(sum = sum(count),
pc = count / sum) |>
mutate(sentiment = fct_relevel(sentiment,
c("surprise",
"anticipation",
"joy",
"trust",
"positive",
"negative",
"sadness",
"fear",
"anger",
"disgust"))) |>
ggplot(aes(x = pc, y = fct_rev(sentiment))) +
geom_col(aes(fill = sentiment)) +
scale_fill_manual(
values =c(
"anger" = "#780000",
"disgust" = "#c1121f",
"fear" = "#9e2a2b",
"negative" = "#bc4749",
"sadness" = "#b56576",
"anticipation" = "#90e0ef",
"joy" = "#00b4d8",
"surprise" = "#caf0f8",
"positive" = "#0077b6",
"trust" = "#118ab2"
)
) +
facet_wrap(~rating, scales = "free") +
scale_x_continuous(labels = percent) +
guides(fill = "none") +
theme(strip.background = element_rect(fill = "black")) +
labs(title = "Breakdown of NRC sentiments in Google reviews by rating",
subtitle = "In the Klang Valley.",
y = "",
x = "")
google_rating_words |>
inner_join(get_sentiments("nrc")) |>
group_by(sentiment, rating, rowid) |>
summarise(count = n_distinct(word),
.groups = "drop")
google_rating_words |>
inner_join(get_sentiments("nrc")) |>
group_by(sentiment, rating, rowid) |>
summarise(count = n_distinct(word),
.groups = "drop") |>
group_by(rating, sentiment) |>
summarise(reviews = n_distinct(rowid),
.groups = "drop")
google_rating_words |>
inner_join(get_sentiments("nrc")) |>
group_by(sentiment, rating, rowid) |>
summarise(count = n_distinct(word),
.groups = "drop") |>
group_by(rating, sentiment) |>
summarise(reviews = n_distinct(rowid),
.groups = "drop") |>
group_by(rating) |>
mutate(sum = sum(reviews),
pc = count / sum) |>
ungroup() |>
mutate(sentiment = fct_relevel(sentiment,
c("surprise",
"anticipation",
"joy",
"trust",
"positive",
"negative",
"sadness",
"fear",
"anger",
"disgust"))) |>
ggplot(aes(x = pc, y = fct_rev(sentiment))) +
geom_col(aes(fill = sentiment)) +
scale_fill_manual(
values =c(
"anger" = "#780000",
"disgust" = "#c1121f",
"fear" = "#9e2a2b",
"negative" = "#bc4749",
"sadness" = "#b56576",
"anticipation" = "#90e0ef",
"joy" = "#00b4d8",
"surprise" = "#caf0f8",
"positive" = "#0077b6",
"trust" = "#118ab2"
)
) +
facet_wrap(~rating, scales = "free") +
scale_x_continuous(labels = percent) +
guides(fill = "none") +
theme(strip.background = element_rect(fill = "black")) +
labs(title = "Breakdown of NRC sentiments in Google reviews by rating",
subtitle = "In the Klang Valley.",
y = "",
x = "")
google_rating_words |>
inner_join(get_sentiments("nrc")) |>
group_by(sentiment, rating, rowid) |>
summarise(count = n_distinct(word),
.groups = "drop") |>
group_by(rating, sentiment) |>
summarise(reviews = n_distinct(rowid),
.groups = "drop") |>
group_by(rating) |>
mutate(sum = sum(reviews),
pc = reviews / sum) |>
ungroup() |>
mutate(sentiment = fct_relevel(sentiment,
c("surprise",
"anticipation",
"joy",
"trust",
"positive",
"negative",
"sadness",
"fear",
"anger",
"disgust"))) |>
ggplot(aes(x = pc, y = fct_rev(sentiment))) +
geom_col(aes(fill = sentiment)) +
scale_fill_manual(
values =c(
"anger" = "#780000",
"disgust" = "#c1121f",
"fear" = "#9e2a2b",
"negative" = "#bc4749",
"sadness" = "#b56576",
"anticipation" = "#90e0ef",
"joy" = "#00b4d8",
"surprise" = "#caf0f8",
"positive" = "#0077b6",
"trust" = "#118ab2"
)
) +
facet_wrap(~rating, scales = "free") +
scale_x_continuous(labels = percent) +
guides(fill = "none") +
theme(strip.background = element_rect(fill = "black")) +
labs(title = "Breakdown of NRC sentiments in Google reviews by rating",
subtitle = "In the Klang Valley.",
y = "",
x = "")
trip_rating_words |>
inner_join(get_sentiments("nrc")) |>
group_by(sentiment, rating, rowid) |>
summarise(count = n_distinct(word),
.groups = "drop") |>
group_by(rating, sentiment) |>
summarise(reviews = n_distinct(rowid),
.groups = "drop") |>
group_by(rating) |>
mutate(sum = sum(reviews),
pc = reviews / sum) |>
ungroup() |>
mutate(sentiment = fct_relevel(sentiment,
c("surprise",
"anticipation",
"joy",
"trust",
"positive",
"negative",
"sadness",
"fear",
"anger",
"disgust"))) |>
ggplot(aes(x = pc, y = fct_rev(sentiment))) +
geom_col(aes(fill = sentiment)) +
scale_fill_manual(
values =c(
"anger" = "#780000",
"disgust" = "#c1121f",
"fear" = "#9e2a2b",
"negative" = "#bc4749",
"sadness" = "#b56576",
"anticipation" = "#90e0ef",
"joy" = "#00b4d8",
"surprise" = "#caf0f8",
"positive" = "#0077b6",
"trust" = "#118ab2"
)
) +
facet_wrap(~rating, scales = "free") +
scale_x_continuous(labels = percent) +
guides(fill = "none") +
theme(strip.background = element_rect(fill = "black")) +
labs(title = "Breakdown of NRC sentiments in Google reviews by rating",
subtitle = "In the Klang Valley.",
y = "",
x = "")
