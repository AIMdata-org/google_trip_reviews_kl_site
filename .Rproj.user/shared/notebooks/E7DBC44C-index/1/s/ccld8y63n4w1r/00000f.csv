"0",""
"0","compare_google_trip <- function(tbl){"
"0","  "
"0","  tbl |> "
"0","    group_by(restaurant, cuisine) |> "
"0","    summarise(reviews = n(), "
"0","              mean_rating = mean(rating), "
"0","              median_rating = median(rating), "
"0","              mode_rating = Mode(rating),"
"0","              .groups = ""drop"") |>  "
"0","    filter(reviews >= 20)"
"0","  }"
"0",""
"0","plot_google_trip <- function(tbl){"
"0","  "
"0","  tbl |> "
"0","    ggplot(aes(x = reviews, "
"0","               y = mean_rating)) +"
"0","    geom_point(aes(colour = median_rating), "
"0","               alpha = .4) + "
"0","    # scale_size_continuous(limits = c(1, 10)) +"
"0","    scale_x_log10(labels = comma) +"
"0","    scale_colour_viridis(option = ""turbo"", begin = .15, end = .9, direction = -1, "
"0","                         labels = label_number(accuracy = .1)) +"
"0","    # ggrepel::geom_text_repel(aes(label = cuisine)) + "
"0","    geom_smooth(method = ""lm"", alpha = .1, size = 0, span = .5) + "
"0","    geom_smooth(method = ""lm"", se = FALSE, alpha = .1, size = .2) + "
"0","    labs(subtitle = ""Restaurants with less than 20 reviews excluded"", "
"0","         x = ""Number of reviews"","
"0","         y = ""Mean Rating"","
"0","         colour = ""Median Rating"") +"
"0","    theme(legend.title = element_text(size = 9), "
"0","          legend.text = element_text(size = 7),"
"0","          legend.key.size = unit(0.9, ""lines""))"
"0","    "
"0","}"
"0","  "
"0",""
"0","google_kl_cuisine |> "
"0","  compare_google_trip() |> "
"0","  plot_google_trip() + "
"0","  # ylim(3.8, 4.6) +"
"0","  labs(title = ""Google reviews"") +"
"0","  guides(size = guide_legend(override.aes = list(alpha = 1))) +"
"0",""
"0","trip_kl_cuisine |> "
"0","  compare_google_trip() |> "
"0","  plot_google_trip() + "
"0","  # ylim(3.8, 4.6) +"
"0","  labs(title = ""Trip Advisor reviews"") +"
"0","  guides(size = ""none"") +"
"0","  "
"0","  plot_annotation(title = ""Klang Valley restaurants and average ratings"") +"
"0","  plot_layout(guides = ""collect"") & theme(legend.position = ""bottom"")"
