"0",""
"0","google_kl_cuisine |> "
"0","  mutate(count = 1) |> "
"0","  group_by(cuisine) |> "
"0","  summarise(reviews = n(), "
"0","            five_star_reviews = sum(count[rating == 5]), "
"0","            mean_rating = mean(rating)) |> "
"0","  mutate(five_star_pc = five_star_reviews / reviews, "
"0","         source = ""Google"")|> "
"0","  select(five_star_pc, cuisine, source, reviews, mean_rating) |> "
"0","  rbind("
"0","    trip_kl_cuisine |> "
"0","      mutate(count = 1) |> "
"0","      group_by(cuisine) |> "
"0","      summarise(reviews = n(), "
"0","                five_star_reviews = sum(count[rating == 5]), "
"0","                mean_rating = mean(rating)) |> "
"0","      mutate(five_star_pc = five_star_reviews / reviews, "
"0","             source = ""Trip Advisor"") |> "
"0","      select(cuisine, five_star_pc, source, reviews, mean_rating)"
"0","  ) |> "
"0","  ggplot(aes(x = five_star_pc, "
"0","             y = fct_reorder(cuisine, mean_rating), "
"0","             fill = mean_rating)) + "
"0","  geom_col(alpha = .7) + "
"0","  scale_x_continuous(labels = percent) +"
"0","  geom_text(aes(label = comma(reviews)), "
"0","            position = position_dodge(width = .9), "
"0","            hjust = ""inward"", "
"0","            colour = ""grey20"") + "
"0","  scale_fill_viridis(direction = -1, begin = .15, option = ""turbo"") +"
"0","  facet_wrap(~ source) + "
"0","  theme(strip.background = element_rect(fill = ""black""), "
"0","        strip.text = element_text(face = ""bold""),"
"0","        legend.title = element_text(size = 9), "
"0","          legend.text = element_text(size = 7),"
"0","          legend.key.size = unit(0.9, ""lines"")) +"
"0","  labs(x = ""% of reviews that are five-stars"", "
"0","       y = """", "
"0","       title = ""% of reviews that are five stars on Google and Trip Advisor, by cuisine"", "
"0","       subtitle = ""Only restaurants in the Klang Valley. Total number of reviews at the end of each bar."", "
"0","       fill = ""Mean\nrating"")"
