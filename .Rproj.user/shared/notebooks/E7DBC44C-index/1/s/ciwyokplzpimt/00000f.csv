"0",""
"0","restaurant_fuzzy_match <- stringdist_join("
"0","  trip_reviews |> "
"0","    filter(location %in% c(""KL"", ""Petaling Jaya"", ""Shah Alam"")) |> "
"0","    distinct(restaurant) |> "
"0","    mutate(restaurant_match = str_remove_all(restaurant, ""Restaurant|Cuisine|restaurant|Restoran|Curry House|Japanese""), "
"0","           restaurant_match = trimws(restaurant_match)) |> "
"0","    select(restaurant_trip = restaurant, "
"0","           restaurant_match), "
"0","  google_kl_cuisine |> filter(location %in% c(""KL"", ""Petaling Jaya"", ""Shah Alam"")) |> "
"0","    distinct(restaurant)|> "
"0","    mutate(restaurant_match = str_remove_all(restaurant, ""Restaurant|Cuisine|restaurant|Restoran|Curry House|Japanese""),"
"0","           restaurant_match = trimws(restaurant_match)) |> "
"0","    select(restaurant_google = restaurant, "
"0","           restaurant_match), "
"0","  by = ""restaurant_match"", "
"0","  ignore_case = TRUE, "
"0","  method = ""jw"","
"0","  max_dist = 99, "
"0","  distance_col = ""dist"""
"0",") |> "
"0","  group_by(restaurant_match.x) |> "
"0","  slice_min(order_by = dist, n = 1) |> "
"0","  arrange((dist)) |> "
"0","  select(match_x = restaurant_match.x, "
"0","         match_y = restaurant_match.y, "
"0","         dist,"
"0","         restaurant_google, "
"0","         restaurant_trip) |>"
"0","  ungroup()"
"0",""
"0","both_google_and_trip <- restaurant_fuzzy_match |> "
"0","  filter(match_x != ""Teh Laris Cafe"" | match_y != ""Thosai Cafe"") |> "
"0","  filter(match_x != ""The Ming Room"" | match_y != ""The Living Room"") |>"
"0","  filter(match_x != ""Cilantro & Wine Bar"" | match_y != ""ZENZERO & Wine Bar"") |> "
"0","  filter(match_x != ""Kedai Kopi Pak Ngah"" | match_y != ""Kedai Kopi Lai Foong"") |> "
"0","  filter(match_x != ""Shanghai"" | match_y != ""Old Shanghai"") |> "
"0","  filter(match_x != ""Ah Ni Bak Kut Teh"" | match_y != ""Ah Sang Bak Kut Teh"") |> "
"0","  filter(match_x != ""Pin Wei Seafood"" | match_y != ""Hoi Peng Seafood"") |> "
"0","  filter(match_x != ""Cafe Cafe"" | match_y != ""Cafe ETC"") |> "
"0","  filter(match_x != ""Tao Chinese"" | match_y != ""Ee Chinese"") |>"
"0","  filter(match_x != ""Seoul Garden"" | match_y != ""Lemon Garden"") |>"
"0","  filter(match_x != ""De.Wan"" | match_y != ""Dewakan"") |>"
"0","  filter(dist <= 0.16666667)"
"0",""
"0","combined_google_trip <- trip_kl_cuisine |> "
"0","  filter(restaurant %in% both_google_and_trip$restaurant_trip) |> "
"0","  select(cuisine, location, restaurant, rating, review) |>"
"0","  mutate(source = ""TripAdvisor"") |> "
"0","  rbind("
"0","    google_kl_cuisine |> "
"0","      filter(restaurant %in% both_google_and_trip$restaurant_google) |> "
"0","      select(cuisine, location, restaurant, rating, review) |> "
"0","      mutate(source = ""Google"")"
"0","  ) |> "
"0","  mutate(row_id = row_number()) |> "
"0","  left_join("
"0","    both_google_and_trip |> "
"0","      distinct(restaurant_google, restaurant_trip) |>"
"0","      rename(restaurant = restaurant_trip),"
"0","    by = c(""restaurant"")"
"0","  ) |> "
"0","  left_join("
"0","    both_google_and_trip |> "
"0","      distinct(restaurant_google, restaurant_trip) |>"
"0","      rename(restaurant = restaurant_google),"
"0","    by = c(""restaurant"")"
"0","  ) |> "
"0","  mutate(restaurant_new = ifelse(!is.na(restaurant_google), "
"0","                                 restaurant_google, "
"0","                                 restaurant)) |> "
"0","  group_by(row_id, location, cuisine, restaurant = restaurant_new, review, source) |> "
"0","  summarise(rating = mean(rating), "
"0","            .groups = ""drop"") |> "
"0","  mutate(restaurant = trimws(restaurant))"
"0",""
