"0",""
"0","# Putting in the finished plot, instead of evaluating again"
"0","# so that I can embed a link to the full-size plot in the image"
"0",""
"0","combined_google_trip |> "
"0","  mutate(new_rating = ifelse(rating %in% c(5), 1, 0)) |> "
"0","  group_by(restaurant, source) |> "
"0","  summarise(new_rating = mean(new_rating), "
"0","            .groups = ""drop"") |> "
"0","  pivot_wider(names_from = ""source"", "
"0","              values_from = new_rating) |> "
"0","  left_join("
"0","    combined_google_trip |> "
"0","      count(restaurant, "
"0","            name = ""count""), "
"0","    by = ""restaurant"""
"0","  ) |> "
"0","  left_join("
"0","    combined_google_trip |> "
"0","      distinct(restaurant, cuisine), "
"0","    by = ""restaurant"""
"0","  ) |> "
"0","  filter(!is.na(Google) & !is.na(TripAdvisor)) |> "
"0","  ggplot(aes(x = Google, y = TripAdvisor)) + "
"0","  geom_smooth(alpha = .1, size = 0, span = .5) + "
"0","  stat_smooth(geom = ""line"", alpha = .1, size =.5, span = .5) +"
"0","  geom_point(aes(colour = cuisine, "
"0","                 size = count)) + "
"0","  scale_colour_viridis_d(option = ""turbo"") +"
"0","  ggrepel::geom_text_repel(aes(label = restaurant), "
"0","                           size = 1.2) + "
"0","  scale_x_continuous(labels = percent, breaks = c(0, 0.2, 0.3, 0.4, 0.5, "
"0","                                                  0.6, 0.7, 0.8, 0.9, 1), "
"0","                     limits = c(0.2, .87)) + "
"0","  scale_y_continuous(labels = percent, breaks = c(0, 0.2, 0.3, 0.4, 0.5, "
"0","                                                  0.6, 0.7, 0.8, 0.9, 1), "
"0","                     limits = c(0.2, .94)) +"
"0","  scale_size_continuous(breaks = c(100, 500, 1000, 2000)) +"
"0","  labs(title = ""Comparison between Google and TripAdvisor using percentage of 5-star reviews"", "
"0","       subtitle = ""Size indicates number of reviews."", "
"0","       y = ""% of 5-star ratings, Trip Advisor"", "
"0","       x = ""% of 5-star ratings, Google"","
"0","       caption = ""Sources: Google; TripAdvisor; Ng Choon Khon."","
"0","       colour = ""Cuisine"", "
"0","       size = ""Review count"") + "
"0","  # guides(colour = guide_legend(override.aes = list(size = .7))) +"
"0","  theme(legend.title = element_text(size = 6), "
"0","        legend.text = element_text(size = 6), "
"0","        legend.key.size = unit(0.3, ""lines""))"
